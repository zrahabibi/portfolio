name: Deploy to GitHub Pages

on:
  # Ù‡Ø± Ø¨Ø§Ø± Ú©Ù‡ Ø¨Ù‡ Ø¨Ø±Ù†Ú† main Ù¾ÙˆØ´ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯ØŒ Ø§ÛŒÙ† Ø§Ú©Ø´Ù† Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯
  push:
    branches: [ main ]
  # Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ø§ÛŒÙ† Ø§Ú©Ø´Ù† Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø³ØªÛŒ Ù‡Ù… Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
  workflow_dispatch:

# Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ø§Ú©Ø´Ù†ØŒ Ø¯Ø± Ø±ÛŒÙ¾Ø§Ø²ÛŒØªÙˆØ±ÛŒ Ø´Ù…Ø§ ØªØºÛŒÛŒØ±Ø§Øª Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†Ø¯ (Ø¨Ø±Ø§ÛŒ Ø¯ÛŒÙ¾Ù„ÙˆÛŒ)
permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18' # Ø§Ø² ÛŒÚ© Ù†Ø³Ø®Ù‡ Ù…Ø¯Ø±Ù† Node Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Build SvelteKit site
        run: npm run build

      - name: Rename 404.html for SPA Fallback
        run: cp build/404.html build/200.html

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './build'

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4